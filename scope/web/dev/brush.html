<html>

<head>
    <title>Genome Browser</title>
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/style0/lib.css">
    <script type="text/javascript" src="/lib/d3.v4.min.js"></script>
    <script type="text/javascript" src="/lib/jquery.min.js"></script>
    <script type="text/javascript" src="/lib/bootstrap.min.js"></script>
    <script type="text/javascript" src="/lib0/brush.js"></script>
    <script type="text/javascript" src="/lib0/axis.js"></script>

</head>

<body>

    <div id="top" class="menu">
        <label for="width"> width </label> <span id="width"></span>
        <label for="height"> height </label> <span id="height"></span>
    </div>
    <div id="left" class="container">
    </div>
    <div id="main" class="container">
        <svg width=600 height=600 transform="translate(10,10)">
        </svg>
    </div>
</body>
<script>
    (function(S) {
        var dispatch = d3.dispatch("new")
        var scale1 = d3.scaleLinear().domain([0, 200]).range([0, 200])
        var scale2 = d3.scaleLinear().domain([0, 300]).range([0, 300])
        var b = S.brush()
            .x(250)
            .y(0)
            .theta(Math.PI / 4)
            //.theta(0)
            .border([
                [0, 0],
                [200 / Math.SQRT2, 300 / Math.SQRT2]
            ])
            .on("brush", function(d) {
                dispatch.call("new", this, d)
            })

        var svg = d3.select("svg")
        var axis1 = S.axis().x(0).y(250).scale(scale1)
        var axis2 = S.axis().x(200).y(250).scale(scale2)
        svg.call(axis1)
        svg.call(axis2)
        svg.call(b)
        var t1 = function(d) {
            return d * Math.SQRT2
        }
        var t2 = function(d) {
            return 300 - d * Math.SQRT2
        }
        dispatch.on("new", function(d) {
            console.log(d)
            axis2.response({
                "start": t2(d[1][1]),
                "end": t2(d[0][1])
            })
            axis1.response({
                "start": t1(d[0][0]),
                "end": t1(d[1][0])
            })
        })



    }(snow))
</script>

</html>
