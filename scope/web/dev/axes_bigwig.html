<html>

<head>
    <title>Genome Browser</title>
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/style0/lib.css">
    <script type="text/javascript" src="/lib/d3.v4.min.js"></script>
    <script type="text/javascript" src="/lib/d3-queue.v2.min.js"></script>
    <script type="text/javascript" src="/lib/d3-request.v1.min.js"></script>
    <script type="text/javascript" src="/lib/jquery.min.js"></script>
    <script type="text/javascript" src="/lib/bootstrap.min.js"></script>
    <script type="text/javascript" src="/lib0/brush.js"></script>
    <script type="text/javascript" src="/lib0/axis.js"></script>
    <script type="text/javascript" src="/lib0/axes.js"></script>
    <script type="text/javascript" src="/lib0/bigwig.js"></script>

</head>

<body>

    <div id="top" class="menu">
        <label for="width"> width </label> <span id="width"></span>
        <label for="height"> height </label> <span id="height"></span>
    </div>
    <div id="left" class="container">
    </div>
    <div id="main" class="container">
        <canvas width=900 height=800 style="postion:absolute;left:0px;top:0px">
        </canvas>
        <svg width=900 height=800 style="position:absolute;left:0px;top:0px">
        </svg>

    </div>
</body>
<script>
    (function(S) {
        var svg = d3.select("svg")
        var canvas = d3.select("canvas")
        var panel = d3.select("#main")
        var B = S.dataBigwig;
        var regions = [{
            "chr": "chr1",
            "start": 1,
            "end": 1000000
        }, {
            "chr": "chr2",
            "start": 1000000,
            "end": 3000000
        }]
        var render = function(regions) {
            svg.selectAll("*").remove(); //TODO
            svg.call(S.axes().regions(regions).on("submit", function(d) {
                render(d)
            }).on("brush", function(d) {
                console.log("resp", d)
                bw.response(d)
            }))
            var bw = B.canvas()
                .URI("/bw")
                .id("chipseq") //TODO
                .x(0)
                .y(450)
                .width(800)
                .gap(20) //TODO REMV
                .regions(regions)
                .panel(panel)
                .pos(1)
            canvas.call(bw)
        }

        render(regions)




    }(snow))
</script>

</html>
