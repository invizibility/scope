<html>

<head>
    <title>Genome Browser</title>
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/style0/lib.css">
    <script type="text/javascript" src="/lib/d3.v4.min.js"></script>
    <script type="text/javascript" src="/lib/d3-queue.v2.min.js"></script>
    <script type="text/javascript" src="/lib/d3-request.v1.min.js"></script>
    <script type="text/javascript" src="/lib/jquery.min.js"></script>
    <script type="text/javascript" src="/lib/bootstrap.min.js"></script>
</head>

<body>

    <!--
    <div id="top" class="menu">
        <label for="width"> width </label> <span id="width"></span>
        <label for="height"> height </label> <span id="height"></span>
    </div>
    <div id="left" class="container">
    </div>
    <div id="main" class="container">
    </div>
  -->
</body>
<script type="text/javascript" src="/lib0/lib.js"></script>
<script type="text/javascript" src="/lib0/bigwig.js"></script>
<script>
    (function(d3, $, S) {
        var B = S.dataBigwig;
        var body = d3.select("body")
        var scope = {} //TODO
        var top = body.append("div").attr("id", "top")
            .classed("container", true)
        var main = body.append("div").attr("id", "main")
            .classed("container", true)
        var left = body.append("div").attr("id", "left")
            .classed("container", true)
        top.append("label").attr("for", "width").text("width")
        var width = top.append("span").attr("id", "width")
        top.append("label").attr("for", "height").text("height")
        var height = top.append("span").attr("id", "height")
        var panel = main.append("div").style("position", "relative")
        var canvas = panel.append("canvas").style("postion", "absolute")
            //var svgdiv = main.append("div").style("position", "absolute") //TO GET X Y for region 1 and region 2.
            //var svg = svgdiv.append("svg") //design for brushes.
        var background = "#BBB"

        $(window).resize(function() {
            resize()
        })
        var resize = function() {
            //var canvasdiv = d3.select("#canvasdiv")
            scope.width = $(window).width() - 200
            scope.height = $(window).height() - 30
            canvas.attr("width", scope.width).attr("height", scope.height)
                //svg.attr("width", scope.width).attr("height", scope.height)
            main.style("height", scope.height + "px")
            main.style("width", scope.width + "px")
            width.text(scope.width)
            height.text(scope.height)
                //var b = svg.append("g").attr("class", "brush")
                //b.call(brush)

        }
        resize()
        var regionCtrl, bigwigCtrl, paraMonitor;
        var regionCtrlPanel = left.append("div").classed("panel", true)
            //regionCtrlPanel.append("div").classed("panel-heading", true).text("Regions Ctrl")
        var regionCtrlDiv = regionCtrlPanel.append("div").classed("panel-body", true)
        var CtrlPanel = left.append("div").classed("panel", true)
        var CtrlDiv = CtrlPanel.append("div").classed("panel-body", true)
        var plot = function(d) {
            var ctx = canvas.node().getContext("2d");
            ctx.fillStyle = background
        }
        var btns = left.append("div").classed("btn-group", true)
        var btns2 = left.append("div").classed("btn-group", true)
        var entry = "/bw"
        var renderCtrlPanel = function(d) {
            console.log(d)
            d3.json(entry + "/list/" + d.trackIds[0], function(c) {
                console.log(c)
                regionCtrl = S.regionForm().chrs(c.Chrs).regionNum(2).send(plot)
                regionCtrlDiv.call(regionCtrl)
            })
            bigwigCtrl = S.dataBigwig.form().data(d).number(2)
            CtrlDiv.call(bigwigCtrl)

        }
        B.Get(entry, renderCtrlPanel)
    }(d3, jQuery, snow));
</script>

</html>
